# import sqlite3
# conn = sqlite3.connect('data/exploitable_db.sqlite')
# c = conn.cursor()

# def connect(username, password):
#   query = f"""
#     SELECT *
#     FROM users
#     WHERE users.username = '{username}'
#     AND users.password = '{password}'
#   """
#   c.execute(query)
#   user = c.fetchone()
#   if user is None:
#     return "Unauthorized"
#   else:
#     return "Authorized"

import sqlite3

conn = sqlite3.connect('data/exploitable_db.sqlite')
c = conn.cursor()

def connect_safe(username, password):
  query = f"""
    SELECT *
    FROM users
    WHERE users.username = ?
    AND users.password = ?
  """
  c.execute(query, (username, password))
  user = c.fetchone()
  if user is None:
    return "Unauthorized"
  else:
    return "Authorized"

print(connect_safe("john", "wrong_password"))
print(connect_safe("john", "passw0rd"))
print(connect_safe("john", "'OR 1=1 --"))
