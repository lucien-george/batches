import sqlite3
conn = sqlite3.connect('data/exploitable_db.sqlite')
c = conn.cursor()

def connect(username, password):
  query = f"""
    SELECT *
    FROM users
    WHERE users.username = :username
    AND users.password = :password
  """
  # c.execute(query, (username, password))
  c.execute(query, { 'username': username, 'password': password })
  user = c.fetchone()
  if user is None:
    return "Unauthorized"
  else:
    return "Authorized"

username = "john"
password = "' OR 1=1 --passw0dierd"
print(connect(username, password))
